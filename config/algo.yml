paper_trading:
  enabled: true
  balance: 100000

feature_flags:
  enable_direction_before_chain: true
  enable_auto_subscribe_unsubscribe: true
  enable_demand_driven_services: true
  enable_underlying_aware_exits: false
  enable_peak_drawdown_activation: false
  auto_paper_on_insufficient_balance: false

# ============================================
# INDEX CONFIG (TREND-SCORE DRIVEN)
# ============================================
indices:
  - key: NIFTY
    segment: IDX_I
    sid: "13"
    capital_alloc_pct: 0.30
    max_same_side: 1
    cooldown_sec: 180
    direction: bullish

    premium_band:
      min: 30
      max: 120

    otm_rules:
      max_otm: 2 # ATM → +1 OTM → +2 OTM

    risk_model:
      base_risk_pct: 0.01 # 1% base
      strong_trend_pct: 0.01
      weak_trend_pct: 0.005

    trade_limits:
      max_trades_per_day: 3

    # Per-index ADX thresholds (overrides global if specified)
    adx_thresholds:
      primary_min_strength: 14 # 1m ADX threshold (70% of typical ~20)
      confirmation_min_strength: 11 # 5m ADX threshold (70% of typical ~15.5)

    strategies:
      open_interest:
        enabled: true
        priority: 1
      momentum_buying:
        enabled: true
        priority: 2
        min_rsi: 60
      btst:
        enabled: true
        priority: 3
      swing_buying:
        enabled: true
        priority: 4

  - key: BANKNIFTY
    segment: IDX_I
    sid: "25"
    capital_alloc_pct: 0.30
    max_same_side: 1
    cooldown_sec: 180
    direction: bullish

    premium_band:
      min: 60
      max: 180

    otm_rules:
      max_otm: 2

    risk_model:
      base_risk_pct: 0.02 # 2% base
      strong_trend_pct: 0.02
      weak_trend_pct: 0.01

    trade_limits:
      max_trades_per_day: 1

    # Per-index ADX thresholds (overrides global if specified)
    adx_thresholds:
      primary_min_strength: 18 # 1m ADX threshold (use global default)
      confirmation_min_strength: 31 # 5m ADX threshold (70% of typical ~44)

    strategies:
      open_interest:
        enabled: true
        priority: 1
      momentum_buying:
        enabled: true
        priority: 2
        min_rsi: 60
      btst:
        enabled: true
        priority: 3
      swing_buying:
        enabled: true
        priority: 4

  - key: SENSEX
    segment: IDX_I
    sid: "51"
    capital_alloc_pct: 0.30
    max_same_side: 1
    cooldown_sec: 180
    direction: bullish

    premium_band:
      min: 40
      max: 150

    otm_rules:
      max_otm: 2

    risk_model:
      base_risk_pct: 0.005 # 0.5% base
      strong_trend_pct: 0.005
      weak_trend_pct: 0.0025

    trade_limits:
      max_trades_per_day: 2

    # Per-index ADX thresholds (overrides global if specified)
    adx_thresholds:
      primary_min_strength: 18 # 1m ADX threshold (70% of typical ~25.5)
      confirmation_min_strength: 10 # 5m ADX threshold (70% of typical ~13.5)

    strategies:
      open_interest:
        enabled: true
        priority: 1
      momentum_buying:
        enabled: true
        priority: 2
        min_rsi: 60
      btst:
        enabled: true
        priority: 3
      swing_buying:
        enabled: true
        priority: 4

trade_limits:
  global_max_trades_per_day: 8

# ============================================
# RISK MODEL (NEMESIS V3)
# ============================================
risk:
  sl_pct: 0.30 # 30% fixed SL (entry * 0.70)
  tp_pct: 0.60 # 60% fixed TP (entry * 1.60)

  # Micro-Trailing model (tiered)
  trailing_tiers:
    - { trigger_pct: 5, sl_offset_pct: -15 }
    - { trigger_pct: 10, sl_offset_pct: -5 }
    - { trigger_pct: 15, sl_offset_pct: 0 }
    - { trigger_pct: 25, sl_offset_pct: 10 }
    - { trigger_pct: 40, sl_offset_pct: 20 }
    - { trigger_pct: 60, sl_offset_pct: 30 }
    - { trigger_pct: 80, sl_offset_pct: 40 }
    - { trigger_pct: 120, sl_offset_pct: 60 }

  peak_drawdown_exit_pct: 5 # Instant exit on -5% drop from peak

  daily_limits:
    enable: true
    per_index:
      NIFTY: 0.02 # 2% max loss for NIFTY
      BANKNIFTY: 0.04 # 4% max loss for BANKNIFTY
      SENSEX: 0.01 # 1% max loss for SENSEX
    global_limit_pct: 0.04

# ============================================
# SIGNAL SETTINGS
# ============================================
signals:
  primary_timeframe: "1m"
  confirmation_timeframe: "5m"

  # Supertrend+ADX Strategy Configuration
  # By default: 1m Supertrend signal is enabled (no config needed)
  # ADX filter and 5m confirmation are toggleable
  enable_supertrend_signal: true # Enable 1m Supertrend signal (default: true)
  enable_adx_filter: true # Enable ADX strength filter (default: false)
  enable_confirmation_timeframe: true # Enable 5m HTF confirmation (default: false)

  trend_scorer:
    min_trend_score: 14
    mtf_enabled: true

  validation_mode: balanced

  supertrend:
    period: 7
    base_multiplier: 3.0

  adx:
    # Global ADX thresholds (used as fallback if per-index thresholds not specified)
    min_strength: 18 # ADX threshold for 1m timeframe (when enabled)
    confirmation_min_strength: 20 # ADX threshold for 5m confirmation (when enabled)
    # Note: Per-index thresholds in indices[].adx_thresholds override these values

# ============================================
# OPTION CHAIN SETTINGS
# ============================================
chain_analyzer:
  max_candidates: 2
  strike_distance_pct: 0.02
  min_oi: 10000
  min_iv: 5.0
  max_iv: 60.0
  max_spread_pct: 0.03

  scoring_weights:
    oi: 0.4
    spread: 0.25
    iv: 0.2
    volume: 0.15

option_chain:
  min_iv: 10
  max_iv: 60
  min_oi: 50000
  max_spread_pct: 3.0

data_freshness:
  disable_ohlc_caching: false
  disable_option_chain_caching: false
  ohlc_cache_duration_minutes: 5
  option_chain_cache_duration_minutes: 2
